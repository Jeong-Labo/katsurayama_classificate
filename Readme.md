# 葛山製作所の異常検知
## 1. 仕様
商品の状態を内視鏡で撮影した画像を入力に、以下4種類に分類したい。
- OK  
目立った傷・切削痕も無く、問題なく出荷可能。
- Level 1  
細かな汚れや傷があるが、出荷自体は可能。
- Level 3  
少々目立つ傷や切削痕があり、差し戻し案件。
- Level 5  
出荷不可。最低でもこの状態は判定したい。

## 2. ファイル構成
データセットは `dataset/train/` / `dataset/val` にレベル別で設置してください。  
学習済みモデルはこちらから（[Google drive]()）  
詳細は、金澤（[a19108@numazu.kosen-ac.jp]()）まで。  

## 3. 動作確認環境
- python == 3.7.9
- Pillow == 8.0.0
- tensorboard == 2.2.0
- torch	== 1.6.0
- torchvision == 0.7.0

## 4. 実行
#### 画像処理のみでの対応
これから。グレースケールや2値化してからエッジの面積とるとか？
#### VGG16を用いた画像分類
※データの前処理はILSVRC2012準拠でやった。
- demo.py : 推論の実行。`$ python demo.py` で動くはず。
- train.py : 訓練の実行。教師データのパスを確認して、`$ python demo.py` で動くはず。

> 結果があまり芳しくない。おそらく前処理の問題が大きいが、転移学習のためにそうせざるを得ない。
> 1から学習しようにもデータ数的に足りるとは考えにくい。
#### GANを用いた異常検知
これから。
